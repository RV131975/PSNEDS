<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Digital Signage ‚Äì Tech ‚Ä¢ Tempo ‚Ä¢ Cota√ß√µes</title>
<link rel="preconnect" href="https://api.open-meteo.com">
<link rel="preconnect" href="https://olinda.bcb.gov.br">
<link rel="preconnect" href="https://api.frankfurter.app">
<link rel="preconnect" href="https://api.coingecko.com">
<style>
  :root{
    --bg:#0b1b2b;
    --bg-dim:#0f2338;
    --card:#0e2134;
    --muted:#7ea0c9;
    --text:#e8f0fa;
    --accent:#4cc0ff;
    --up:#36c16b;
    --down:#e35b5b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: Inter, Roboto, "Segoe UI", system-ui, -apple-system, sans-serif;
    color:var(--text); background: radial-gradient(1200px 800px at 70% 30%, #0e2a44 0%, #0b1b2b 60%) fixed;
  }
  /* Subtle tech background */
  body:before{
    content:""; position:fixed; inset:0; pointer-events:none; opacity:.18;
    background:
      radial-gradient(circle at 20% 30%, rgba(255,255,255,.06) 0 2px,transparent 2px 100%),
      radial-gradient(circle at 80% 70%, rgba(255,255,255,.05) 0 2px,transparent 2px 100%),
      repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 1px, transparent 1px 120px),
      repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 1px, transparent 1px 120px);
  }

  .wrap{
    height:100vh; width:100vw; padding:24px; display:grid; gap:18px;
    grid-template-rows: 80px 1fr 70px;
    grid-template-columns: 1fr 420px;
    grid-template-areas:
      "top top"
      "main side"
      "footer footer";
  }

  /* Top bar */
  .top{ grid-area:top; display:grid; grid-template-columns: 260px 1fr 280px; gap:16px; align-items:center; }
  .brand{
    display:flex; align-items:center; gap:14px; height:100%;
  }
  .brand img{ height:44px; object-fit:contain; filter: drop-shadow(0 2px 6px rgba(0,0,0,.3)); }
  .brand .name{ font-weight:800; letter-spacing:.06em; font-size:28px }
  .top .now{
    justify-self:center; text-align:center;
  }
  .now-time{ font-size:34px; font-weight:700; letter-spacing:.02em }
  .now-date{ font-size:14px; color:var(--muted) }
  .weather{
    justify-self:end; background:var(--card); border-radius:14px; padding:10px 14px; display:flex; align-items:center; gap:12px;
    box-shadow: 0 8px 24px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.06);
    min-width:260px;
  }
  .w-icon{ font-size:28px }
  .w-temp{ font-size:24px; font-weight:700 }
  .w-city{ font-size:13px; color:var(--muted) }

  /* Main + side */
  .main{ grid-area:main; background:rgba(255,255,255,.02); border:1px solid rgba(255,255,255,.06);
    border-radius:18px; padding:24px; position:relative; overflow:hidden; display:flex; flex-direction:column; gap:18px;
  }
  .main:before{
    content:""; position:absolute; inset:-40% -40% auto auto; width:120%; height:120%;
    background: radial-gradient(closest-side, rgba(76,192,255,.08), transparent 70%);
    transform: translateY(-35%);
    pointer-events:none;
  }
  .headline{
    background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.06); border-radius:16px;
    padding:24px; font-size:28px; font-weight:700; line-height:1.25; backdrop-filter: blur(6px);
  }
  .news-list{ display:grid; gap:14px; grid-auto-rows:minmax(0,1fr); overflow:auto; }
  .news-card{
    display:grid; grid-template-columns: 120px 1fr; gap:16px; align-items:center;
    background:var(--card); border-radius:14px; padding:12px; border:1px solid rgba(255,255,255,.06);
  }
  .news-card img{ width:120px; height:72px; object-fit:cover; border-radius:10px }
  .news-card h4{ margin:0; font-size:16px }
  .news-card p{ margin:4px 0 0; font-size:13px; color:var(--muted) }
  .news-card a{ color: var(--accent); text-decoration:none }
  .news-header{ display:flex; align-items:center; justify-content:space-between; }
  .news-header .title{ font-weight:700; color:var(--muted); letter-spacing:.08em; text-transform:uppercase; font-size:13px }

  .side{ grid-area:side; display:grid; gap:18px }
  .panel{ background:rgba(255,255,255,.02); border:1px solid rgba(255,255,255,.06); border-radius:18px; padding:18px }
  .panel h3{ margin:0 0 10px; font-size:14px; text-transform:uppercase; letter-spacing:.1em; color:var(--muted) }
  .stats{ display:grid; gap:10px }
  .stat{
    display:flex; align-items:center; justify-content:space-between;
    background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:12px 14px;
  }
  .stat .label{ font-weight:600 }
  .stat .val{ font-weight:800; font-variant-numeric: tabular-nums; }
  .stat .delta{ font-size:12px; opacity:.9 }
  .delta.up{ color:var(--up) } .delta.down{ color:var(--down) }

  /* Footer ticker */
  .footer{ grid-area:footer; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1);
    border-radius:14px; overflow:hidden; position:relative;
  }
  .marquee{
    position:absolute; white-space:nowrap; will-change: transform;
    animation: slide 25s linear infinite; font-size:18px; padding:22px 0; color:#dbe8f8;
  }
  @keyframes slide{
    from{ transform:translateX(100%) }
    to{ transform:translateX(-100%) }
  }

  /* Scrollbar subtle */
  ::-webkit-scrollbar{ height:8px; width:10px }
  ::-webkit-scrollbar-thumb{ background:rgba(255,255,255,.12); border-radius:8px }
</style>
</head>
<body>
  <div class="wrap">
    <!-- TOP -->
    <header class="top">
      <div class="brand">
        <!-- Substitua pela sua marca -->
        <img src="https://dummyimage.com/180x44/1e90ff/ffffff&text=PSNE" alt="Logo">
        <div class="name" id="brandName">PSNE</div>
      </div>
      <div class="now">
        <div class="now-time" id="nowTime">--:--</div>
        <div class="now-date" id="nowDate">---</div>
      </div>
      <div class="weather" id="weatherBox" title="Atualiza a cada ~5 min">
        <div class="w-icon" id="weatherIcon">‚õÖ</div>
        <div class="w-temp" id="weatherTemp">--¬∞</div>
        <div class="w-city" id="weatherCity">Localizando‚Ä¶</div>
      </div>
    </header>

    <!-- MAIN -->
    <main class="main">
      <div class="headline" id="headline">Inova√ß√£o em Redes & IA: atualiza√ß√µes em tempo real</div>

      <div class="news-header">
        <div class="title">Not√≠cias de Tecnologia</div>
        <div style="font-size:12px;color:var(--muted)">Fonte: RSS (TechCrunch, The Verge, etc.)</div>
      </div>
      <section class="news-list" id="newsList" aria-live="polite">
        <!-- Cards de not√≠cia entram via JS -->
      </section>
    </main>

    <!-- SIDE -->
    <aside class="side">
      <section class="panel">
        <h3>Cota√ß√µes ‚Ä¢ Atualiza 5 min</h3>
        <div class="stats">
          <div class="stat">
            <span class="label">USD / BRL</span>
            <span class="val" id="usdbrl">--</span>
            <span class="delta" id="usdbrlDelta">--</span>
          </div>
          <div class="stat">
            <span class="label">EUR / USD</span>
            <span class="val" id="eurusd">--</span>
            <span class="delta" id="eurusdDelta">--</span>
          </div>
          <div class="stat">
            <span class="label">BTC / USD</span>
            <span class="val" id="btcusd">--</span>
            <span class="delta" id="btcusdDelta">--</span>
          </div>
        </div>
      </section>

      <section class="panel">
        <h3>Pr√≥ximos Destaques</h3>
        <ul style="margin:0;padding-left:18px;line-height:1.6;color:var(--muted)" id="bullets">
          <li>SRv6 e redes Cloud-Scale</li>
          <li>Observabilidade com IA (PSNE Observer)</li>
          <li>Automa√ß√£o de provisionamento (GitOps / API-first)</li>
          <li>FinOps para Telco Cloud</li>
        </ul>
      </section>
    </aside>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="marquee" id="ticker">
        Transformando redes em intelig√™ncia ‚Ä¢ Zero-Touch Operations ‚Ä¢ SLA orientado a valor ‚Ä¢ Seguran√ßa by-design ‚Ä¢ Edge-to-Cloud ‚Ä¢ 5G & FWA ‚Ä¢ DataOps ‚Ä¢ Cultura de SRE ‚Ä¢ Atendimento 24x7 ‚Ä¢ PSNE ‚Äî 100% Tech, 100% Cliente
      </div>
    </footer>
  </div>

<script>
(() => {
  // ============== CONFIGURA√á√ÉO ==============
  const CONFIG = {
    // Cidade padr√£o caso geolocaliza√ß√£o falhe
    fallbackCity: { name: "Miami, FL", lat: 25.7617, lon: -80.1918, tz: "America/New_York" },

    // Feeds de not√≠cias (RSS). Voc√™ pode ajustar.
    newsFeeds: [
      "https://techcrunch.com/feed/",
      "https://www.theverge.com/rss/index.xml",
      "https://feeds.arstechnica.com/arstechnica/index"
    ],

    refresh: {
      clockMs: 1000,
      weatherMs: 5 * 60 * 1000,
      fxMs: 5 * 60 * 1000,
      newsMs: 15 * 60 * 1000
    },

    // qde de not√≠cias a exibir
    newsLimit: 6
  };

  // ============== UTILIT√ÅRIOS ==============
  const fmt = new Intl.NumberFormat('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  const fmt4 = new Intl.NumberFormat('pt-BR', { minimumFractionDigits: 4, maximumFractionDigits: 4 });

  const byId = id => document.getElementById(id);

  function setDelta(el, value) {
    if (!el) return;
    if (value === null || Number.isNaN(value)) { el.textContent = "--"; el.className = "delta"; return; }
    const sign = value === 0 ? "" : (value > 0 ? "+" : "");
    el.textContent = `${sign}${fmt(value)}%`;
    el.className = "delta " + (value > 0 ? "up" : value < 0 ? "down" : "");
  }

  function weatherIconFromCode(code, isDay=true){
    // Open-Meteo WMO code mapping (simplified)
    const sun = "‚òÄÔ∏è", moon="üåô", cloud="‚õÖ", over="‚òÅÔ∏è", rain="üåßÔ∏è", tstorm="‚õàÔ∏è", snow="‚ùÑÔ∏è", fog="üå´Ô∏è";
    const day = isDay ? sun : moon;
    if ([0].includes(code)) return day;
    if ([1,2].includes(code)) return cloud;
    if ([3].includes(code)) return over;
    if ([45,48].includes(code)) return fog;
    if ([51,53,55,56,57,61,63,65,80,81,82].includes(code)) return rain;
    if ([66,67,71,73,75,77,85,86].includes(code)) return snow;
    if ([95,96,99].includes(code)) return tstorm;
    return "‚õÖ";
  }

  // Simple localStorage cache with TTL
  const cache = {
    get(key){
      try{
        const raw = localStorage.getItem(key);
        if(!raw) return null;
        const {expires, data} = JSON.parse(raw);
        if (Date.now() > expires) { localStorage.removeItem(key); return null; }
        return data;
      }catch{ return null; }
    },
    set(key, data, ttlMs){
      localStorage.setItem(key, JSON.stringify({ data, expires: Date.now() + ttlMs }));
    }
  };

  // ============== REL√ìGIO ==============
  function startClock(){
    const timeEl = byId("nowTime");
    const dateEl = byId("nowDate");
    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || CONFIG.fallbackCity.tz;

    function tick(){
      const now = new Date();
      timeEl.textContent = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute:'2-digit' });
      dateEl.textContent = now.toLocaleDateString('pt-BR', { weekday:'long', day:'2-digit', month:'long', year:'numeric', timeZone: tz });
    }
    tick();
    setInterval(tick, CONFIG.refresh.clockMs);
  }

  // ============== CLIMA (Open-Meteo) ==============
  async function getCoords(){
    return new Promise(resolve => {
      if (!navigator.geolocation) return resolve(CONFIG.fallbackCity);
      const done = (lat, lon, name) => resolve({ lat, lon, name, tz: Intl.DateTimeFormat().resolvedOptions().timeZone || CONFIG.fallbackCity.tz });

      const toName = async (lat, lon) => {
        try{
          const url = `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`;
          const res = await fetch(url);
          const j = await res.json();
          const city = j.city || j.locality || j.principalSubdivision || "Local";
          const country = j.countryCode ? `, ${j.countryCode}` : "";
          done(lat, lon, `${city}${country}`);
        }catch{ done(lat, lon, CONFIG.fallbackCity.name); }
      };

      const onSuccess = pos => toName(pos.coords.latitude, pos.coords.longitude);
      const onError   = () => done(CONFIG.fallbackCity.lat, CONFIG.fallbackCity.lon, CONFIG.fallbackCity.name);
      navigator.geolocation.getCurrentPosition(onSuccess, onError, { timeout: 5000 });
    });
  }

  async function loadWeather(){
    const box = byId("weatherBox");
    const tempEl = byId("weatherTemp");
    const iconEl = byId("weatherIcon");
    const cityEl = byId("weatherCity");

    const cached = cache.get("weather");
    if (cached){
      tempEl.textContent = `${Math.round(cached.temp)}¬∞`;
      iconEl.textContent = weatherIconFromCode(cached.code, cached.is_day===1);
      cityEl.textContent = cached.city || CONFIG.fallbackCity.name;
    }

    try{
      const loc = await getCoords();
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${loc.lat}&longitude=${loc.lon}&current_weather=true&timezone=${encodeURIComponent(loc.tz)}`;
      const res = await fetch(url);
      const j = await res.json();
      const { temperature, weathercode, is_day } = j.current_weather;
      tempEl.textContent = `${Math.round(temperature)}¬∞`;
      iconEl.textContent = weatherIconFromCode(weathercode, is_day===1);
      cityEl.textContent = loc.name || CONFIG.fallbackCity.name;
      cache.set("weather", { temp: temperature, code: weathercode, is_day, city: loc.name }, CONFIG.refresh.weatherMs);
      box.style.opacity = 1;
    }catch(e){
      box.title = "Falha ao obter clima";
      box.style.opacity = .7;
    }
  }

  // ============== COTA√á√ïES ==============
  function pctDelta(curr, prev){
    if (!prev || prev === 0) return null;
    return ((curr - prev)/prev) * 100;
  }

  async function loadFX(){
    const usdValEl = byId("usdbrl");
    const usdDeltaEl = byId("usdbrlDelta");
    const eurValEl = byId("eurusd");
    const eurDeltaEl = byId("eurusdDelta");

    // Carrega cache inicial
    const cacheFX = cache.get("fx") || {};
    if (cacheFX.usdbrl){ usdValEl.textContent = fmt4.format(cacheFX.usdbrl.value); setDelta(usdDeltaEl, cacheFX.usdbrl.delta ?? null); }
    if (cacheFX.eurusd){ eurValEl.textContent = fmt4.format(cacheFX.eurusd.value); setDelta(eurDeltaEl, cacheFX.eurusd.delta ?? null); }

    try{
      // taxa atual
      const latest = await fetch("https://api.exchangerate.host/latest?base=USD&symbols=BRL,EUR").then(r=>r.json());
      const usdbrl = latest.rates?.BRL;
      const usdeur = latest.rates?.EUR;
      const eurusd = usdeur ? (1/usdeur) : null;

      // taxa de ontem (para delta)
      const d = new Date(); d.setDate(d.getDate()-1);
      const ymd = d.toISOString().slice(0,10);
      const prev = await fetch(`https://api.exchangerate.host/${ymd}?base=USD&symbols=BRL,EUR`).then(r=>r.json());
      const prevUsdBrl = prev.rates?.BRL;
      const prevUsdEur = prev.rates?.EUR;
      const prevEurUsd = prevUsdEur ? (1/prevUsdEur) : null;

      usdValEl.textContent = usdbrl ? fmt4.format(usdbrl) : "--";
      setDelta(usdDeltaEl, pctDelta(usdbrl, prevUsdBrl));

      eurValEl.textContent = eurusd ? fmt4.format(eurusd) : "--";
      setDelta(eurDeltaEl, pctDelta(eurusd, prevEurUsd));

      cache.set("fx", {
        usdbrl:{ value: usdbrl, delta: pctDelta(usdbrl, prevUsdBrl) },
        eurusd:{ value: eurusd, delta: pctDelta(eurusd, prevEurUsd) }
      }, CONFIG.refresh.fxMs);
    }catch(e){
      usdDeltaEl.textContent = "‚Äî";
      eurDeltaEl.textContent = "‚Äî";
    }
  }

  async function loadBTC(){
    const valEl = byId("btcusd");
    const deltaEl = byId("btcusdDelta");
    const cached = cache.get("btc");
    if (cached){ valEl.textContent = fmt.format(cached.value); setDelta(deltaEl, cached.delta ?? null); }
    try{
      const res = await fetch("https://api.coindesk.com/v1/bpi/currentprice/USD.json");
      const j = await res.json();
      const price = Number(j.bpi?.USD?.rate_float ?? j.bpi?.USD?.rate?.replace(/,/g, ''));
      // pegar pre√ßo de ~24h atr√°s
      const d = new Date(); d.setDate(d.getDate()-1);
      const y = d.toISOString().slice(0,10);
      const hist = await fetch(`https://api.coindesk.com/v1/bpi/historical/close.json?currency=USD&start=${y}&end=${y}`).then(r=>r.json());
      const prev = Object.values(hist.bpi ?? {})[0];
      valEl.textContent = price ? fmt.format(price) : "--";
      setDelta(deltaEl, pctDelta(price, prev));
      cache.set("btc", { value: price, delta: pctDelta(price, prev) }, CONFIG.refresh.fxMs);
    }catch(e){
      deltaEl.textContent = "‚Äî";
    }
  }

  // ============== NOT√çCIAS (RSS -> XML via fetch) ==============
  async function fetchRSS(url){
    // Nota: alguns feeds exigem CORS; para produ√ß√£o use um pequeno proxy HTTPS pr√≥prio se necess√°rio.
    // Truque: muitos funcionam com `https://api.allorigins.win/raw?url=ENCODED_URL`
    const proxied = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
    const res = await fetch(proxied, { cache: "no-store" });
    const text = await res.text();
    const parser = new DOMParser();
    const xml = parser.parseFromString(text, "text/xml");
    const items = [...xml.querySelectorAll("item")].slice(0, 10).map(it => ({
      title: it.querySelector("title")?.textContent?.trim(),
      link: it.querySelector("link")?.textContent?.trim(),
      desc: (it.querySelector("description")?.textContent || "").replace(/<[^>]+>/g,"").trim(),
      pub: it.querySelector("pubDate")?.textContent ? new Date(it.querySelector("pubDate").textContent) : null
    }));
    return items;
  }

  function pickHeroTitle(items){
    // pega a mais recente ou a de maior tamanho de descri√ß√£o
    const sorted = [...items].sort((a,b)=>{
      const ta = a.pub ? a.pub.getTime() : 0;
      const tb = b.pub ? b.pub.getTime() : 0;
      return tb - ta || (b.desc?.length||0) - (a.desc?.length||0);
    });
    return sorted[0]?.title || "Tend√™ncias de tecnologia atualizadas em tempo real";
  }

  async function loadNews(){
    const listEl = byId("newsList");
    const headlineEl = byId("headline");

    const cached = cache.get("news");
    if (cached){
      headlineEl.textContent = cached.headline;
      renderNews(listEl, cached.items);
    } else {
      // placeholder enquanto carrega
      listEl.innerHTML = `<div class="news-card"><div style="height:72px;background:#17314b;border-radius:10px"></div><div><h4>Carregando not√≠cias‚Ä¶</h4><p>Aguarde alguns segundos.</p></div></div>`;
    }

    try{
      const results = (await Promise.allSettled(
        CONFIG.newsFeeds.map(u => fetchRSS(u))
      ))
      .filter(r => r.status === "fulfilled")
      .flatMap(r => r.value);

      // dedup por link/t√≠tulo
      const seen = new Set();
      const unique = results.filter(x=>{
        const k = x.link || x.title;
        if(!k || seen.has(k)) return false;
        seen.add(k); return true;
      });

      // ordena por data desc
      unique.sort((a,b)=>{
        const ta = a.pub ? a.pub.getTime() : 0;
        const tb = b.pub ? b.pub.getTime() : 0;
        return tb - ta;
      });

      const top = unique.slice(0, CONFIG.newsLimit);
      const hero = pickHeroTitle(top);
      headlineEl.textContent = hero;
      renderNews(listEl, top);

      cache.set("news", { headline: hero, items: top }, CONFIG.refresh.newsMs);
    }catch(e){
      // fallback simples
      headlineEl.textContent = headlineEl.textContent || "Atualiza√ß√µes de tecnologia";
      if (!cached){
        listEl.innerHTML = `
          <div class="news-card">
            <div style="height:72px;background:#17314b;border-radius:10px"></div>
            <div><h4>N√£o foi poss√≠vel carregar o feed agora.</h4><p>Tente recarregar a p√°gina ou habilitar CORS/usar um proxy.</p></div>
          </div>`;
      }
    }
  }

  function renderNews(container, items){
    container.innerHTML = items.map(it => `
      <article class="news-card">
        <img src="https://picsum.photos/seed/${encodeURIComponent(it.title?.slice(0,24)||Math.random())}/240/144" alt="thumb">
        <div>
          <h4>${it.title || "Sem t√≠tulo"}</h4>
          <p>${it.desc?.slice(0,120) || ""}</p>
          ${it.link ? `<a href="${it.link}" target="_blank" rel="noopener">Ler mais ‚Üí</a>` : ""}
        </div>
      </article>
    `).join("");
  }

  // ============== INICIALIZA√á√ÉO + INTERVALOS ==============
  function init(){
    startClock();
    loadWeather();   setInterval(loadWeather,   CONFIG.refresh.weatherMs);
    loadFX();        setInterval(loadFX,        CONFIG.refresh.fxMs);
    loadBTC();       setInterval(loadBTC,       CONFIG.refresh.fxMs);
    loadNews();      setInterval(loadNews,      CONFIG.refresh.newsMs);

    // Ajuste de velocidade do ticker conforme largura do texto
    const ticker = byId("ticker");
    const updateAnim = () => {
      const w = ticker.scrollWidth || 2000;
      const dur = Math.max(18, w / 80); // ~80px/s
      ticker.style.animationDuration = `${dur}s`;
    };
    new ResizeObserver(()=>updateAnim()).observe(ticker);
    updateAnim();
  }

  document.addEventListener("DOMContentLoaded", init);
})();
</script>
</body>
</html>
